#!/usr/bin/env node
var fs = require("fs");
var path = require("path");

if (!fs.watch) {
    console.log("Your system does not support fs.watch");
    console.log("buster-autotest will unfortunately not work.");
    console.log("Please consult the Node documentation for more information.");
    process.exit(1);
}

var autotest = require("buster-autotest");
var argv = process.argv.slice(2);
var cwd = process.cwd();
var command = __dirname + "/buster-test";

if (command.indexOf(cwd) >= 0) {
    command = "./" + path.relative(cwd, command);
}

autotest.watch(cwd, { argv: argv, cmd: command });
console.log("Watching", cwd);
console.log("Test command:");
console.log("    buster-test", argv.join(" "), "\n");
console.log("Have fun!");
